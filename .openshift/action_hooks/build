#!/bin/bash
export JAVA_HOME=/etc/alternatives/java_sdk_1.8.0
export PATH=${JAVA_HOME}/bin:${PATH}
export JAVACMD=${JAVA_HOME}/bin/java

# In bash, to use rm -- !(file.txt), you must enable extglob:
shopt -s extglob

# Build gradle project
cd ${OPENSHIFT_REPO_DIR}
sh ${M2_HOME}/bin/mvn clean package --settings .openshift/settings.xml -Dmaven.test.skip=true

# Move final artifact to repo dir
mv ${OPENSHIFT_REPO_DIR}/build/libs/home-server-*.jar ${OPENSHIFT_REPO_DIR}

# Clean up to regain some diskspace
#cd ${OPENSHIFT_REPO_DIR}/build/libs
#rm -R -- !(*.jar)
